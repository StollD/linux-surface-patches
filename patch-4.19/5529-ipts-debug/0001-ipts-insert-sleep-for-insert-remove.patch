From 1608263f7744e67a3f3bf2efe5c9dc026d8f932b Mon Sep 17 00:00:00 2001
From: kitakar5525 <34676735+kitakar5525@users.noreply.github.com>
Date: Fri, 2 Aug 2019 21:04:04 +0900
Subject: [PATCH] ipts: insert sleep for insert/remove

---
 drivers/gpu/drm/i915/intel_ipts.c    | 4 ++++
 drivers/misc/ipts/ipts-msg-handler.c | 5 +++++
 2 files changed, 9 insertions(+)

diff --git a/drivers/gpu/drm/i915/intel_ipts.c b/drivers/gpu/drm/i915/intel_ipts.c
index 3d3c35398..bbc1e6eac 100644
--- a/drivers/gpu/drm/i915/intel_ipts.c
+++ b/drivers/gpu/drm/i915/intel_ipts.c
@@ -618,6 +618,8 @@ int intel_ipts_init(struct drm_device *dev)
 	intel_ipts.initialized = true;
 	pr_info("ipts: Intel iTouch framework initialized\n");
 
+	msleep(3000);
+
 	return ret;
 }
 
@@ -648,4 +650,6 @@ void intel_ipts_cleanup(struct drm_device *dev)
 		destroy_ipts_context();
 		cancel_delayed_work(&intel_ipts.reacquire_db_work);
 	}
+
+	msleep(3000);
 }
diff --git a/drivers/misc/ipts/ipts-msg-handler.c b/drivers/misc/ipts/ipts-msg-handler.c
index db5356a1c..380ca2496 100644
--- a/drivers/misc/ipts/ipts-msg-handler.c
+++ b/drivers/misc/ipts/ipts-msg-handler.c
@@ -1,4 +1,5 @@
 #include <linux/mei_cl_bus.h>
+#include <linux/delay.h>
 
 #include "ipts.h"
 #include "ipts-hid.h"
@@ -141,6 +142,8 @@ int ipts_start(ipts_info_t *ipts)
 
 	ret = ipts_handle_cmd(ipts, TOUCH_SENSOR_NOTIFY_DEV_READY_CMD, NULL, 0);
 
+	msleep(3000);
+
 	return ret;
 }
 
@@ -164,6 +167,8 @@ void ipts_stop(ipts_info_t *ipts)
 
 		return;
 	}
+
+	msleep(3000);
 }
 
 int ipts_restart(ipts_info_t *ipts)
-- 
2.22.0

